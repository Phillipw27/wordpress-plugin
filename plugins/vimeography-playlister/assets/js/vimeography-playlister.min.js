window.vimeography=window.vimeography||{},window.vimeography.playlister=function(i){this.gallery_settings=i,this.utilities=new window.vimeography.utilities2,this.locate_elements(i.gallery_id),this.setup_events()},window.vimeography.playlister.prototype.locate_elements=function(i){this.$gallery=this.utilities.get_gallery(i),this.$player=this.$gallery.find(".vimeography-player"),this.$thumbnails=this.$gallery.find(".vimeography-thumbnails")},window.vimeography.playlister.prototype.setup_events=function(){this.$thumbnails.find("figure").eq(0).addClass("vimeography-active"),this.bind_video_insert_toggle(),void 0!==this.gallery_settings.containing_uri&&this.$thumbnails.find('a[data-uri="'+this.gallery_settings.containing_uri+'"]').trigger("click"),this.utilities.set_video_id(this.$player.find("iframe").prop("outerHTML")),void 0!==this.gallery_settings.pagination&&this.add_pagination(),void 0!==this.gallery_settings.playlist&&(this.bind_playlist_listener(),this.add_playlist()),this.$gallery.trigger("vimeography/video/ready")},window.vimeography.playlister.prototype.bind_video_insert_toggle=function(){var i=this;i.$gallery.find(".vimeography-thumbnails").on("click","a.vimeography-video",function(e){i.scroll_to_video(jQuery(this)),i.set_video_data(jQuery(this)),i.embed_video(jQuery(this).attr("href")),e.preventDefault()})},window.vimeography.playlister.prototype.scroll_to_video=function(i){this.$thumbnails.stop().scrollTo(i,800)},window.vimeography.playlister.prototype.set_video_data=function(i){var e=this,t=i.data("title"),a=i.data("duration"),l=i.data("description"),o={hd:i.data("download-hd"),sd:i.data("download-sd"),mobile:i.data("download-mobile"),source:i.data("download-source")};e.$gallery.find(".vimeography-thumbnails .vimeography-active").removeClass("vimeography-active"),i.parent().addClass("vimeography-active"),e.$gallery.find(".vimeography-info h1").html(t),e.$gallery.find(".vimeography-info h2").html(a),e.$gallery.find(".vimeography-info p").html(l),e.$gallery.find(".vimeography-info .vimeography-download-links").empty(),void 0!==o.sd&&$.each(o,function(i,a){void 0!==a&&e.$gallery.find(".vimeography-info .vimeography-download-links").append('<a href="'+a+'" download="'+t+'" title="Download '+t+'">'+i+"</a>")})},window.vimeography.playlister.prototype.embed_video=function(i){var e=this,t=e.$player.parent();t.spin("custom"),e.$player.animate({opacity:0},300,"linear",function(){var a=e.utilities.get_video(i);a.done(function(i){i.html=e.utilities.set_video_id(i.html),e.$player.html(i.html).fitVids().animate({opacity:1},300),t.spin(!1),e.$gallery.trigger("vimeography/video/ready")})})},window.vimeography.playlister.prototype.add_pagination=function(){var i=this,e=new window.vimeography.pagination2(i.gallery_settings.pagination),t=Math.ceil(e.total/e.per_page),a=!1;i.$thumbnails.bind("scroll",function(){if(!a&&e.current_page!=t&&jQuery(this).scrollTop()+jQuery(this).innerHeight()>=this.scrollHeight-200){a=!0;var l=jQuery("<div />").data("go-to","next"),o=e.paginate(l);o.done(function(e){a=!1,"success"==e.result&&i.$thumbnails.append(e.html)})}})},window.vimeography.playlister.prototype.bind_playlist_listener=function(){var i=this;i.$gallery.on("vimeography/playlist/next",function(){document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),document.webkitExitFullscreen&&document.webkitExitFullscreen();var e=i.$thumbnails.find(".vimeography-active").next();e.length&&e.find("a.vimeography-video").trigger("click")})},window.vimeography.playlister.prototype.add_playlist=function(){this.utilities.enable_autoplay=1,this.utilities.enable_playlist(this.gallery_settings.gallery_id)},jQuery(function(i){i.each(window.vimeography.galleries.playlister,function(i,e){new window.vimeography.playlister(e)})});